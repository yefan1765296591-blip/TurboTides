{{- partial "analytics" . -}}
<meta charset="utf-8">
<title>{{ .Site.Title }}{{ if not .IsHome }} | {{ .Title }}{{ end }}</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Favicon -->
<link rel="apple-touch-icon" sizes="180x180" href='{{ "apple-touch-icon.png" | absURL }}'>
<link rel="icon" type="image/png" sizes="32x32" href='{{ "favicon-32x32.png" | absURL }}'>
<link rel="icon" type="image/png" sizes="16x16" href='{{ "favicon-16x16.png" | absURL }}'>
<link rel="icon" type="image/x-icon" href='{{ "favicon.ico" | absURL }}'>
<link rel="manifest" href='{{ "site.webmanifest" | absURL }}'>

{{ if .Site.Params.icon.fontawesome }}
<link href='{{ "css/fa6.min.css" | absURL }}' rel="stylesheet" type="text/css">
{{ end }}

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

{{/* 样式管线 */}}
{{ $main := resources.Get "css/style.css" }}
{{ $custom := resources.Get "css/custom.css" | default nil }}
{{ $home := cond .IsHome (resources.Get "css/home.css" | default nil) nil }}
{{ $isNews := or .Params.is_news_page (hasPrefix .RelPermalink "/blog/news/") }}
{{ $news := cond $isNews (resources.Get "css/news.css" | default nil) nil }}
{{ $isCommonPage := or .Params.is_common_page (eq .Type "softwarecases") (hasPrefix .RelPermalink "/other-software/") }}
{{ $commonPage := cond $isCommonPage (resources.Get "css/page-common.css" | default nil) nil }}

{{ $list := slice $main }}
{{ if $custom }}{{ $list = $list | append $custom }}{{ end }}
{{ if $home }}{{ $list = $list | append $home }}{{ end }}
{{ if $news }}{{ $list = $list | append $news }}{{ end }}
{{ if $commonPage }}{{ $list = $list | append $commonPage }}{{ end }}

{{ $bundle := $list | resources.Concat "css/site-bundle.css" }}
{{ if hugo.IsServer }}
<link rel="stylesheet" href="{{ $bundle.RelPermalink }}">
{{ else }}
{{ $bundle = $bundle | minify | fingerprint | resources.PostProcess }}
<link rel="stylesheet" href="{{ $bundle.RelPermalink }}" integrity="{{ $bundle.Data.Integrity }}" crossorigin="anonymous">
{{ end }}

{{ if .IsHome }}
<link rel="stylesheet" href='{{ "css/swiper-bundle.min.css" | absURL }}'>
{{ end }}

<style>
  @font-face {
      font-family: 'icomoon';
      src: url('{{ "css/fonts/icomoon.ttf" | absURL }}') format('truetype');
  }
</style>